// Main function to handle the logic
async function main() {
  try {
    const response = await fetch("https://api.openai.com/v1/chat/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        Authorization: `Bearer OPENAI_API_KEY`, // Replace with your API key
      },
      body: JSON.stringify({
        model: "gpt-4.1-nano",
        temperature: 1,
        top_p: 1.0,
        max_tokens: 70,
        presence_penalty: 0.6,
        frequency_penalty: 0.6,
        messages: [
          {
            role: "system",
            content:
              'You have to be nice and not say anything other than what they ask you to say, for example, if they ask you to say a phrase, do not say "here comes the phrase: blah blah blah..." no no no you do not have to just say the phrase, for example "blah blah blah...". VERY VERY IMPORTANT YOU CANNOT UDER ANY CIRCUMSTANCES SAY ANYTHING THAT HAS MORE THAN 61 CHARACTERS.',
          },
          {
            role: "user",
            content: `Give me a greeting, for example: Have a nice day ðŸ˜Š or something like that, and not always the same emoticon and the same phrase. You have to be a little formal. Don't use I wish you or anything related to wishes. If today is a holiday you can mention it, for example if today is Christmas you can say Merry Christmas and with the time you can also say good morning or night or whatever you want today is ${dateTime}. You can put emojis`,
          },
        ],
      }),
    });

    if (!response.ok) {
      throw new Error(`API error: ${response.statusText}`);
    }

    const data = await response.json();
    const phrase = data.choices[0].message.content;

    console.log("Text generated by the API:", phrase);

    // Call the typewriter effect function
    typeWriterEffect(phrase, "speech-bubble-text");
  } catch (error) {
    console.error("Error fetching the response from OpenAI:", error);
  }
}

// Obtener la fecha y hora actual
const now = new Date();

// Formatear la fecha y hora
const day = now.toLocaleDateString(); // Ejemplo: "07/05/2025"
const time = now.toLocaleTimeString(); // Ejemplo: "14:30:15"

// Combinar dÃ­a y hora en una sola variable
const dateTime = `${day} ${time}`;
console.log("Fecha y hora actual:", dateTime);

// Function for the typewriter effect
function typeWriterEffect(text, elementId) {
  const element = document.getElementById(elementId);
  if (!element) {
    console.error(`Element with ID "${elementId}" not found.`);
    return;
  }

  element.innerHTML = ""; // Clear previous content
  let index = 0;

  function writeCharacter() {
    if (index < text.length) {
      element.innerHTML += text.charAt(index).replace(/\n/g, "<br>");
      index++;
      setTimeout(writeCharacter, 50); // Adjust the timing to control speed
    }
  }

  writeCharacter();
}

// Call the main function
main();
